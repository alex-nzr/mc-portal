{"version":3,"file":"index.bundle.js","sources":["../src/scripts/ui-detail.js","../src/index.js"],"sourcesContent":["/**\n * ==================================================\n * Developer: Alexey Nazarov\n * E-mail: alsnazarov@1cbit.ru\n * Copyright (c) 2019 - 2022\n * ==================================================\n * mc-portal - ui-detail.js\n * 13.07.2022 14:46\n * ==================================================\n */\n\nexport class UiDetail\n{\n\tconstructor(options = {}) {\n\t\tthis.moduleId \t\t\t = options.moduleId;\n\t\tthis.typeId \t\t\t = options.typeId;\n\t\tthis.entityTypeId \t\t = options.entityTypeId;\n\t\tthis.entityId \t\t\t = options.entityId;\n\t\tthis.opportunity\t\t = Number(options.opportunity);\n\t\tthis.isNew\t\t\t\t = options.isNew;\n\t\tthis.typeOfRequest\t\t = options.typeOfRequest;\n\t\tthis.splitBtnDatasetId\t = options.splitBtnDatasetId;\n\t\tthis.pullActions\t\t = options.pullActions;\n\t\tthis.postActionKey  \t = options.postActionKey;\n\t\tthis.splitRequestAction  = options.splitRequestAction;\n\t\tthis.isAdmin\t\t\t = options.isAdmin;\n\n\t\tthis.typeOfRequestNodeId   = 'type_of_request_block';\n\t\tthis.submitSplitFormBtnId  = 'split-request-amount-submit-btn';\n\t\tthis.submitRejectFormBtnId = 'reject-request-submit-btn';\n\n\t\tthis.init();\n\t}\n\n\tinit() {\n\t\tthis.initEntityDetailManager();\n\t\tthis.initEvents();\n\t\tthis.initButtons();\n\t}\n\n\tinitEntityDetailManager(){\n\t\tthis.entityDetailManager = new BX.Cbit.Mc.Core.EntityDetailManager({\n\t\t\tmoduleId: \t\t\t \t     this.moduleId,\n\t\t\ttypeId: \t\t\t \t     this.typeId,\n\t\t\tentityTypeId: \t\t \t     this.entityTypeId,\n\t\t\tentityId: \t\t\t \t     this.entityId,\n\t\t\tisNew:\t\t\t\t \t     this.isNew,\n\t\t\tpageTitleEditable: \t\t     false,\n\t\t\tenableCategorySelector:      false,\n\t\t\tcardConfigEditable: \t     this.isAdmin,\n\t\t\tenableCommunicationControls: false,\n\t\t\tenableSectionCreation: \t     this.isAdmin,\n\t\t\tenableSectionEdit: \t\t     this.isAdmin,\n\t\t\tenableFieldsContextMenu:     false,\n\t\t\tenableSectionEditMode: \t     this.isAdmin,\n\t\t\tshowEmptySections: \t\t     false,\n\t\t\thideTimelineInCreationPage:  true,\n\t\t\tisStageFlowActive:\t\t\t true,\n\t\t\treloadOnStageChange:\t\t true,\n\t\t});\n\t}\n\n\tinitEvents(){\n\t\tBX.addCustomEvent(\"onPullEvent\", BX.delegate(function(moduleId, command, params){\n\t\t\tif ((moduleId === this.moduleId) && (Number(params.itemId) === Number(this.entityId)))\n\t\t\t{\n\t\t\t\tswitch (command) {\n\t\t\t\t\tcase this.pullActions['showRejectReasonPopup']:\n\t\t\t\t\t\tthis.showRejectReasonPopup();\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}, this));\n\n\t\tBX.addCustomEvent('BX.Crm.EntityEditorSection:onLayout', (e) => {\n\t\t\tthis.insertTypeOfRequestToEditorFrom();\n\t\t})\n\t}\n\n\tinitButtons(){\n\t\tthis.splitBtn = document.querySelector(`[data-id=\"${this.splitBtnDatasetId}\"]`);\n\t\tthis.splitBtn && this.splitBtn.addEventListener('click', () => this.showSplitAmountPopup());\n\t}\n\n\tshowRejectReasonPopup() {\n\t\tif (!this.rejectFormPopup)\n\t\t{\n\t\t\tthis.rejectFormNode  = this.createRejectForm();\n\t\t\tthis.rejectFormPopup = BX.PopupWindowManager.create(\n\t\t\t\t\"reject-request-popup\",\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tcontent: this.rejectFormNode,\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tcloseIcon: false,\n\t\t\t\t\ttitleBar: BX.message('UI_DETAIL_REJECT_REQUEST_REASON'),\n\t\t\t\t\tcloseByEsc: false,\n\t\t\t\t\toverlay: {\n\t\t\t\t\t\tbackgroundColor: 'black',\n\t\t\t\t\t\topacity: 500\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\ttext: BX.message('SAVE_TEXT'),\n\t\t\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\t\t\tid: this.submitRejectFormBtnId,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\tthis.submitRejectForm();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\ttext: BX.message('EXIT_TEXT'),\n\t\t\t\t\t\t\tclassName: 'ui-btn ui-btn-default',\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\tthis.rejectFormPopup.close();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.rejectFormPopup.show();\n\t}\n\n\tcreateRejectForm() {\n\t\treturn BX.create('form', {\n\t\t\tchildren: [\n\t\t\t\tBX.create({\n\t\t\t\t\ttag: 'label',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-ctl ui-ctl-textarea ui-ctl-no-resize'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'span',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-tag'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: BX.message('UI_DETAIL_REJECT_REQUEST_REASON')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'textarea',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tname: `REJECT_REASON`,\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-element',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t}),\n\n\t\t\t\tBX.create('input', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\t\tname: 'ITEM_ID',\n\t\t\t\t\t\tvalue: this.entityId\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t}\n\n\tsubmitRejectForm() {\n\t\tif (!this.validateForm(this.rejectFormNode))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst submitBtn =  BX(this.submitRejectFormBtnId);\n\t\tsubmitBtn && submitBtn.classList.add(\"ui-btn-wait\");\n\n\t\tconst formData = new FormData(this.rejectFormNode);\n\n\t\tBX.ajax.runAction('cbit.mc:expense.base.rejectRequest', {\n\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\tdata: formData\n\t\t}).then( response => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tthis.rejectFormPopup.close();\n\t\t\t\tthis.rejectFormPopup.destroy();\n\t\t\t\tthis.rejectFormPopup = null;\n\t\t\t\tthis.rejectFormNode  = null;\n\n\t\t\t\tBX.Cbit?.Mc?.Core?.MainUI?.showSuccessPopup();\n\t\t\t\tBX.Crm.EntityEditor.getDefault().refreshLayout();\n\n\t\t\t\tif (BX.SidePanel?.Instance?.opened)\n\t\t\t\t{\n\t\t\t\t\t//BX.SidePanel.Instance.reload();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t//window.location.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error('Something went wrong. Unknown response status - '.response.status);\n\t\t\t}\n\t\t}).catch(response => {\n\t\t\tconst error = response.errors?.[0]?.message ?? 'Something went wrong. Unknown error';\n\t\t\tBX.Cbit?.Mc?.Core?.MainUI?.showErrorPopup(error);\n\t\t\tsubmitBtn && submitBtn.classList.remove(\"ui-btn-wait\");\n\t\t});\n\t}\n\n\tshowSplitAmountPopup() {\n\t\tif (!this.splitFormPopup)\n\t\t{\n\t\t\tthis.splitFormNode  = this.createSplitForm();\n\t\t\tthis.splitFormPopup = BX.PopupWindowManager.create(\n\t\t\t\t\"split-request-amount-popup\",\n\t\t\t\tnull,\n\t\t\t\t{\n\t\t\t\t\tcontent: this.splitFormNode,\n\t\t\t\t\twidth: 500,\n\t\t\t\t\tcloseIcon: false,\n\t\t\t\t\ttitleBar: BX.message('UI_DETAIL_SPLIT_POPUP_TITLE'),\n\t\t\t\t\tcloseByEsc: false,\n\t\t\t\t\toverlay: {\n\t\t\t\t\t\tbackgroundColor: 'black',\n\t\t\t\t\t\topacity: 500\n\t\t\t\t\t},\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\ttext: BX.message('SAVE_TEXT'),\n\t\t\t\t\t\t\tclassName: 'ui-btn ui-btn-primary',\n\t\t\t\t\t\t\tid: this.submitSplitFormBtnId,\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\tthis.submitSplitForm();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew BX.PopupWindowButton({\n\t\t\t\t\t\t\ttext: BX.message('EXIT_TEXT'),\n\t\t\t\t\t\t\tclassName: 'ui-btn ui-btn-default',\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tclick: () => {\n\t\t\t\t\t\t\t\t\tthis.splitFormPopup.close();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t],\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\tthis.splitFormPopup.show();\n\t}\n\n\tcreateSplitForm() {\n\t\tconst rejectedFormInput = BX.create({\n\t\t\ttag: 'input',\n\t\t\tprops: {\n\t\t\t\tname: `UF_CRM_${this.typeId}_AMOUNT_REJECTED`,\n\t\t\t\tclassName: 'ui-ctl-element',\n\t\t\t},\n\t\t\tattrs: {\n\t\t\t\ttype: 'number',\n\t\t\t\treadonly: true,\n\t\t\t\trequired: true,\n\t\t\t}\n\t\t});\n\n\t\treturn BX.create('form', {\n\t\t\tchildren: [\n\t\t\t\tBX.create({\n\t\t\t\t\ttag: 'label',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-ctl ui-ctl-textbox'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'span',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-tag'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: BX.message('UI_DETAIL_SPLIT_FORM_APPROVED_SUM')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'input',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tname: `OPPORTUNITY`,\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-element',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t\tmin: '0',\n\t\t\t\t\t\t\t\tmax: `${this.opportunity}`,\n\t\t\t\t\t\t\t\tautocomplete: \"new-password\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\t\tinput: (e) => {\n\t\t\t\t\t\t\t\t\tif (Number(e.target.value) > this.opportunity)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\te.target.value = this.opportunity;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (Number(e.target.value) < 0)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\te.target.value = 0;\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\trejectedFormInput.value = this.opportunity - Number(e.target.value);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t}),\n\n\t\t\t\tBX.create({\n\t\t\t\t\ttag: 'label',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-ctl ui-ctl-textbox'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'span',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-tag'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: BX.message('UI_DETAIL_SPLIT_FORM_REJECTED_SUM')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\trejectedFormInput,\n\t\t\t\t\t]\n\t\t\t\t}),\n\n\t\t\t\tBX.create({\n\t\t\t\t\ttag: 'label',\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-ctl ui-ctl-textarea ui-ctl-no-resize'\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'span',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-tag'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: BX.message('UI_DETAIL_SPLIT_FORM_REJECT_REASON')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create({\n\t\t\t\t\t\t\ttag: 'textarea',\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tname: `UF_CRM_${this.typeId}_REASON`,\n\t\t\t\t\t\t\t\tclassName: 'ui-ctl-element',\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tattrs: {\n\t\t\t\t\t\t\t\trequired: true,\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t}),\n\n\t\t\t\tBX.create('input', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\t\tname: 'ITEM_ID',\n\t\t\t\t\t\tvalue: this.entityId\n\t\t\t\t\t}\n\t\t\t\t}),\n\n\t\t\t\tBX.create('input', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\ttype: 'hidden',\n\t\t\t\t\t\tname: this.postActionKey,\n\t\t\t\t\t\tvalue: this.splitRequestAction\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t]\n\t\t});\n\t}\n\n\tsubmitSplitForm() {\n\t\tif (!this.validateForm(this.splitFormNode))\n\t\t{\n\t\t\treturn false;\n\t\t}\n\n\t\tconst submitBtn =  BX(this.submitSplitFormBtnId);\n\t\tsubmitBtn && submitBtn.classList.add(\"ui-btn-wait\");\n\n\t\tconst formData = new FormData(this.splitFormNode);\n\n\t\tBX.ajax.runAction('cbit.mc:expense.base.splitRequestAmount', {\n\t\t\tsessid: BX.bitrix_sessid(),\n\t\t\tdata: formData\n\t\t}).then( response => {\n\t\t\tif (response.status === 'success')\n\t\t\t{\n\t\t\t\tthis.splitFormPopup.close();\n\t\t\t\tthis.splitFormPopup.destroy();\n\t\t\t\tthis.splitFormPopup = null;\n\t\t\t\tthis.splitFormNode  = null;\n\n\t\t\t\tBX.Cbit?.Mc?.Core?.MainUI?.showSuccessPopup();\n\t\t\t\tBX.Crm.EntityEditor.getDefault().refreshLayout();\n\t\t\t\tthis.opportunity = formData.get(`OPPORTUNITY`);\n\n\t\t\t\tif (BX.SidePanel?.Instance?.opened)\n\t\t\t\t{\n\t\t\t\t\tBX.SidePanel.Instance.reload();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t}\n\t\t\t\t//this.splitBtn && this.splitBtn.remove();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthrow new Error('Something went wrong. Unknown response status - '.response.status);\n\t\t\t}\n\t\t}).catch(response => {\n\t\t\tconst error = response.errors?.[0]?.message ?? 'Something went wrong. Unknown error';\n\t\t\tBX.Cbit?.Mc?.Core?.MainUI?.showErrorPopup(error);\n\t\t\tsubmitBtn && submitBtn.classList.remove(\"ui-btn-wait\");\n\t\t});\n\t}\n\n\tvalidateForm(form) {\n\t\tlet result = true;\n\n\t\tconst fields = form.querySelectorAll('input, select, textarea');\n\t\tfields.length && fields.forEach(field => {\n\t\t\tconst parent = field.closest('.ui-ctl');\n\t\t\tif (field.hasAttribute('required') && !field.value)\n\t\t\t{\n\t\t\t\tparent && parent.classList.add('ui-ctl-danger');\n\t\t\t\tresult = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tparent && parent.classList.remove('ui-ctl-danger');\n\t\t\t}\n\t\t})\n\n\t\treturn result;\n\t}\n\n\tinsertTypeOfRequestToEditorFrom() {\n\t\tconst inserted = BX(this.typeOfRequestNodeId);\n\t\tif (!inserted)\n\t\t{\n\t\t\tconst sectionContent = document.querySelector('[data-cid=\"general\"] .ui-entity-editor-section-content');\n\t\t\tif (sectionContent)\n\t\t\t{\n\t\t\t\tsectionContent.prepend(BX.create('div', {\n\t\t\t\t\tprops: {\n\t\t\t\t\t\tclassName: 'ui-entity-editor-content-block',\n\t\t\t\t\t\tid: this.typeOfRequestNodeId\n\t\t\t\t\t},\n\t\t\t\t\tchildren: [\n\t\t\t\t\t\tBX.create('div', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-entity-editor-block-title'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttext: BX.message('TYPE_OF_REQUEST_BLOCK_TITLE')\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tBX.create('div', {\n\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\tclassName: 'ui-entity-editor-content-block'\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t\tBX.create('div', {\n\t\t\t\t\t\t\t\t\tprops: {\n\t\t\t\t\t\t\t\t\t\tclassName: 'ui-entity-editor-content-block-text'\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\thtml: `<b>${this.typeOfRequest}</b>`\n\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}),\n\t\t\t\t\t]\n\t\t\t\t}));\n\t\t\t}\n\t\t}\n\t}\n}","import {UiDetail} from './scripts/ui-detail';\r\nimport './styles/style.css';\r\nimport {Extension} from 'main.core';\r\n\r\nBX.ready(() => {\r\n    try\r\n    {\r\n        BX.Cbit.Mc.Expense.UiDetail = new UiDetail(Extension.getSettings('cbit.mc.expense.ui-detail'));\r\n    }\r\n    catch (e)\r\n    {\r\n        console.log('Expense UiDetail error', e)\r\n    }\r\n});"],"names":["UiDetail","options","moduleId","typeId","entityTypeId","entityId","opportunity","Number","isNew","typeOfRequest","splitBtnDatasetId","pullActions","postActionKey","splitRequestAction","isAdmin","typeOfRequestNodeId","submitSplitFormBtnId","submitRejectFormBtnId","init","initEntityDetailManager","initEvents","initButtons","entityDetailManager","BX","Cbit","Mc","Core","EntityDetailManager","this","pageTitleEditable","enableCategorySelector","cardConfigEditable","enableCommunicationControls","enableSectionCreation","enableSectionEdit","enableFieldsContextMenu","enableSectionEditMode","showEmptySections","hideTimelineInCreationPage","isStageFlowActive","reloadOnStageChange","addCustomEvent","delegate","command","params","itemId","showRejectReasonPopup","e","_this","insertTypeOfRequestToEditorFrom","splitBtn","document","querySelector","addEventListener","_this2","showSplitAmountPopup","rejectFormPopup","rejectFormNode","createRejectForm","PopupWindowManager","create","content","width","closeIcon","titleBar","message","closeByEsc","overlay","backgroundColor","opacity","buttons","PopupWindowButton","text","className","id","events","click","_this3","submitRejectForm","close","show","children","tag","props","name","attrs","required","type","value","validateForm","submitBtn","classList","add","formData","FormData","ajax","runAction","sessid","bitrix_sessid","data","then","response","status","Error","_this4","destroy","MainUI","showSuccessPopup","Crm","EntityEditor","getDefault","refreshLayout","SidePanel","_BX$SidePanel","Instance","_BX$SidePanel$Instanc","opened","error","errors","_response$errors","_response$errors$","showErrorPopup","remove","splitFormPopup","splitFormNode","createSplitForm","_this5","submitSplitForm","rejectedFormInput","readonly","min","max","autocomplete","input","target","_this6","_this7","get","_BX$SidePanel2","_BX$SidePanel2$Instan","reload","window","location","_response$errors2","_response$errors2$","form","result","fields","querySelectorAll","length","forEach","field","parent","closest","hasAttribute","sectionContent","prepend","html","ready","Expense","Extension","getSettings","console","log"],"mappings":"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"}