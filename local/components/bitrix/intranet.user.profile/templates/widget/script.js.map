{"version":3,"file":"script.js","sources":["src/options.js","src/stress-level.js","src/theme-picker.js","src/ustat.js","src/widget.js"],"sourcesContent":["export default class Options {\n\tstatic eventNameSpace = 'BX.Intranet.Userprofile:';\n}","import {Type, Tag, Loc, ajax, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\n\ntype StressLevelResponse = {\n\tid: number,\n\tdate: string,\n\tvalue: number,\n\ttype: string,\n\ttypeDescription: string,\n\tcomment: string,\n\thash: string,\n\turl: {\n\t\tcheck: string,\n\t\tresult: string\n\t}\n};\nexport class StressLevel {\n\tconstructor() {\n\t}\n\n\tstatic getOpenSliderFunction(url)\n\t{\n\t\tif (Type.isStringFilled(url))\n\t\t{\n\t\t\treturn () => {\n\t\t\t\tEventEmitter.emit(EventEmitter.GLOBAL_TARGET, Options.eventNameSpace + 'onNeedToHide');\n\t\t\t\tBX.SidePanel.Instance.open(url, {\n\t\t\t\t\tcacheable: false,\n\t\t\t\t\tdata: {},\n\t\t\t\t\twidth: 500\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn () => {};\n\t}\n\n\tstatic showData(data: StressLevelResponse): Element\n\t{\n\t\tdata.value = parseInt(data.value || 0);\n\n\t\tconst result = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\" id=\"user-indicator-pulse\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress ${data.value > 0 ? '' : '--empty'}\">0</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-block --center --width-100\">\n\t\t\t\t\t\t\t<span class=\"system-auth-form__stress-widget--status  --flex --${Text.encode(data.type)}\">${Text.encode(data.typeDescription)}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" onclick=\"${this.getOpenSliderFunction(data.url.result)}\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${this.getOpenSliderFunction(data.url.check)}\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Text.encode(data.comment)}</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\tsetTimeout(() => {\n\t\t\tconst intervalId = setInterval((value) => {\n\t\t\t\tvalue.current++;\n\t\t\t\tvalue.node.innerHTML = value.current;\n\t\t\t\tif (value.current >= value.end)\n\t\t\t\t{\n\t\t\t\t\tclearInterval(intervalId);\n\t\t\t\t}\n\t\t\t}, 600 / data.value, {\n\t\t\t\tcurrent: 0,\n\t\t\t\tend: data.value,\n\t\t\t\tnode: result.querySelector('[data-role=\"value\"]')\n\t\t\t});\n\t\t\tresult.querySelector('[data-role=\"value-degree\"]').style.transform = 'rotate(' + (1.8 * data.value) + 'deg)'\n\t\t}, 1000);\n\t\treturn result;\n\t}\n\n\tstatic showEmpty({url: {check}}): Element\n\t{\n\t\treturn Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical --empty-stress --clickable\" onclick=\"${this.getOpenSliderFunction(check)}\">\n\t\t\t\t<div class=\"system-auth-form__item-block --margin-bottom\">\n\t\t\t\t\t<div class=\"system-auth-form__stress-widget\">\n\t\t\t\t\t\t<div data-role=\"value-degree\" class=\"system-auth-form__stress-widget--arrow\" style=\"transform: rotate(90deg);\"></div>\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--content-title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_INDICATOR_TEXT')}</div>\n\t\t\t\t\t\t\t<div data-role=\"value\" class=\"system-auth-form__stress-widget--content-progress --empty\">?</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --stress-widget-sp\">\n\t\t\t\t\t\t<div class=\"system-auth-form__stress-widget--message\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-block --flex --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_NORESULT_BUTTON')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_STRESSLEVEL_RESULT_COME_ON')}</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t}\n\n\tstatic getPromise({signedParameters, componentName, userId, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst promise = data ? Promise.resolve({data}) :\n\t\t\t\tajax.runAction('socialnetwork.api.user.stresslevel.get', {\n\t\t\t\t\tsignedParameters: signedParameters,\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tc: componentName,\n\t\t\t\t\t\tfields: {\n\t\t\t\t\t\t\tuserId: userId\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tpromise.then(({data}) => {\n\t\t\t\t\tif (data && data.id !== undefined && data.value !== undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn resolve(this.showData(data));\n\t\t\t\t\t}\n\n\t\t\t\t\tconst node = Loc.getMessage('USER_ID') === userId ?\n\t\t\t\t\t\tthis.showEmpty(data) : document.createElement('DIV');\n\n\t\t\t\t\treturn resolve(node);\n\t\t\t\t})\n\t\t\t\t.catch((error: Error) => {\n\t\t\t\t\tresolve(this.showData({\n\t\t\t\t\t\tid: undefined,\n\t\t\t\t\t\tvalue: undefined,\n\t\t\t\t\t\turls: {\n\t\t\t\t\t\t\tcheck: undefined\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t})\n\t\t\t})\n\t\t;\n\t}\n}","import {Tag, Loc, Type, Dom} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from './options';\n\ntype ThemePickerData = {\n\tid: string,\n\tlightning: ?string,\n\ttitle: string,\n\tpreviewImage: string,\n\tpreviewColor: string\n};\n\nexport default class ThemePicker extends EventEmitter {\n\t#params: ThemePickerData;\n\n\t#container;\n\n\tconstructor(data: ThemePickerData)\n\t{\n\t\tsuper();\n\t\tthis.#params = Object.assign({}, data);\n\t\tthis.#params.lightning = String(data.id).indexOf('light:') === 0 ? 'light' : (\n\t\t\tString(data.id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t);\n\t\tthis.applyTheme = this.applyTheme.bind(this);\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tEventEmitter.subscribe(\n\t\t\t'BX.Intranet.Bitrix24:ThemePicker:onThemeApply',\n\t\t\t({data: {id, theme}}) =>\n\t\t\t{\n\t\t\t\tthis.#params.id =  id;\n\t\t\t\tthis.#params.lightning = String(id).indexOf('light:') === 0 ? 'light' : (\n\t\t\t\t\tString(id).indexOf('dark:') === 0 ? 'dark' : null\n\t\t\t\t);\n\t\t\t\tthis.#params.title = theme.title;\n\t\t\t\tthis.#params.previewImage = theme.previewImage;\n\t\t\t\tthis.#params.previewColor = theme.previewColor;\n\t\t\t\tthis.applyTheme();\n\t\t\t}\n\t\t)\n\t}\n\n\tapplyTheme()\n\t{\n\t\tconst container = this.getContainer();\n\n\t\tcontainer.querySelector('[data-role=\"title\"]').innerHTML = this.#params.title ?? Loc.getMessage('AUTH_THEME_DIALOG');\n\n\t\tif (Type.isStringFilled(this.#params.previewImage) && this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.removeProperty('backgroundImage');\n\t\t\tcontainer.style.removeProperty('backgroundSize');\n\t\t\tcontainer.style.backgroundImage = 'url(\"' + this.#params.previewImage + '\")';\n\t\t\tcontainer.style.backgroundSize = 'cover';\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcontainer.style.background = 'none';\n\t\t}\n\n\t\tif (Type.isStringFilled(this.#params.previewColor))\n\t\t{\n\t\t\tthis.getContainer().style.backgroundColor = this.#params.previewColor;\n\t\t}\n\n\t\tif (!this.#params.lightning)\n\t\t{\n\t\t\tcontainer.style.backgroundColor = 'rgba(255,255,255,1)';\n\t\t}\n\n\t\tDom.removeClass(container, '--light --dark');\n\t\tDom.addClass(container, '--' + this.#params.lightning);\n\t}\n\n\tgetContainer()\n\t{\n\t\tif (this.#container)\n\t\t{\n\t\t\treturn this.#container;\n\t\t}\n\n\t\tconst onclick = () => {\n\t\t\tthis.emit('onOpen');\n\t\t\tBX.Intranet.Bitrix24.ThemePicker.Singleton.showDialog(false);\n\t\t};\n\t\tthis.#container = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --border ${this.#params.lightning ? '--' + this.#params.lightning : ''} --padding-sm\" title=\"${Loc.getMessage('AUTH_THEME_DIALOG')}\">\n\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t<div data-role=\"preview-color\" class=\"system-auth-form__item-logo--image --theme\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --block\">\n\t\t\t\t\t\t<span data-role=\"title\">Theme</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CHANGE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>`;\n\t\tsetTimeout(this.applyTheme, 0);\n\t\treturn this.#container;\n\t}\n\n\tgetPromise()\n\t{\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve(this.getContainer());\n\t\t});\n\t}\n}","import {Text, Type, Tag, Loc, ajax} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport Options from \"./options\";\ntype userPulseUserData = {\n\tFULL_NAME: string,\n\tAVATAR_SRC: string,\n\tID: string\n};\ntype userPulseData = {\n\tUSERS_RATING: {\n\t\tposition: number,\n\t\trange: number,\n\t\ttop: [\n\t\t\t{\n\t\t\t\tUSER_ID: string,\n\t\t\t\tACTIVITY: number\n\t\t\t}\n\t\t]\n\t},\n\tUSERS_INFO: userPulseUserData[]\n};\n\nexport default class Ustat {\n\tdata: userPulseData;\n\tconstructor(data) {\n\t\tthis.data = data;\n\t\tthis.onclickHandle = this.onclickHandle.bind(this);\n\t}\n\n\t#renderUsers()\n\t{\n\t\tconst userList = document.createDocumentFragment();\n\t\tlet myPosition = parseInt(this.data['USERS_RATING']['position']);\n\n\t\tlet myActivity = 0;\n\t\tconst usersData = Type.isPlainObject(this.data['USERS_RATING']['top'])\n\t\t\t? Object.values(this.data['USERS_RATING']['top']) : (\n\t\t\t\tType.isArray(this.data['USERS_RATING']['top']) && this.data['USERS_RATING']['top'].length > 0\n\t\t\t\t\t? [...this.data['USERS_RATING']['top']] : [{'USER_ID': Loc.getMessage('USER_ID'), ACTIVITY: 0}]);\n\t\tconst dataResult = myPosition > 5 ?\n\t\t\t[...usersData.slice(0, 3), ...usersData.slice(-1), null]\n\t\t\t: usersData\n\t\t;\n\t\tdataResult\n\t\t\t.forEach((userRating, index) => {\n\t\t\t\tif (userRating === null)\n\t\t\t\t{\n\t\t\t\t\tuserList.appendChild(Tag.render`<div class=\"system-auth-form__userlist-item --list\"></div>`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlet fullName = userRating['ACTIVITY'];\n\t\t\t\tlet avatarSrc = '';\n\t\t\t\tif (this.data['USERS_INFO'][userRating['USER_ID']])\n\t\t\t\t{\n\t\t\t\t\tfullName = [this.data['USERS_INFO'][userRating['USER_ID']]['FULL_NAME'], ': ', userRating['ACTIVITY']].join('');\n\t\t\t\t\tavatarSrc = String(this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC']).length > 0\n\t\t\t\t\t\t? this.data['USERS_INFO'][userRating['USER_ID']]['AVATAR_SRC'] : null;\n\t\t\t\t}\n\t\t\t\tconst isCurrentUser = String(userRating['USER_ID']) === String(Loc.getMessage('USER_ID'));\n\t\t\t\tif (isCurrentUser)\n\t\t\t\t{\n\t\t\t\t\tmyActivity = userRating['ACTIVITY'];\n\t\t\t\t}\n\t\t\t\tuserList.appendChild(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<div title=\"${Text.encode(fullName)}\" class=\"system-auth-form__userlist-item ui-icon ui-icon ui-icon-common-user\">\n\t\t\t\t\t\t\t<i ${avatarSrc ? `style=\"background-image: url('${avatarSrc}');background-size: cover;\"` : ''}></i>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t`\n\t\t\t\t);\n\t\t\t})\n\t\t;\n\t\treturn {\n\t\t\tuserList,\n\t\t\tmyPosition,\n\t\t\trange: parseInt(this.data['USERS_RATING']['range']),\n\t\t\tmyActivity\n\t\t};\n\t}\n\n\tshowData(): Element\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tlet div;\n\t\tif (range > 0 && myPosition > 0)\n\t\t{\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${this.onclickHandle}\">\n\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --margin-s\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\n\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tconst onclick = range > 0 ? this.onclickHandle : () => {};\n\t\t\tdiv = Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --without-stat ${range > 0 ? '--clickable' : ''}\" onclick=\"${onclick}\">\n\t\t\t\t<div class=\"system-auth-form__item-container --flex --column\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --lighter\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY_BRIEF')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t\t}\n\n\t\tBX.UI.Hint.init(div);\n\t\treturn div;\n\t}\n\n\tonclickHandle(event)\n\t{\n\t\tEventEmitter.emit(Options.eventNameSpace + 'onNeedToHide');\n\t\tif (window['openIntranetUStat'])\n\t\t{\n\t\t\topenIntranetUStat(event);\n\t\t}\n\t}\n\n\tshowWideData()\n\t{\n\t\tconst {myPosition, userList, range} = this.#renderUsers();\n\t\tconst div =  Tag.render`\n\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --center --padding-ustat ${range > 0 ? '--clickable' : '--without-stat'}\">\n\t\t\t\t<div class=\"system-auth-form__item-image\">\n\t\t\t\t\t<div class=\"system-auth-form__item-image--src --ustat\"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --overflow\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --xl --without-margin\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_TITLE')}</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light\" data-role=\"empty-info\">${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_IS_EMPTY')}</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container--inline\" data-role=\"my-position\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-light --without-margin --margin-right\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_RATING')}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --white-space --margin-xl\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_PULSE_MY_POSITION',\n\t\t\t{'#POSITION#': myPosition, '#AMONG#': range})}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__ustat-icon --up\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__userlist\" data-role=\"user-list\">\n\t\t\t\t\t\t${userList}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"system-auth-form__icon-help --absolute-right-bottom\" data-hint=\"${Loc.getMessage('INTRANET_USTAT_COMPANY_HELP_RATING')}\" data-hint-no-icon></div>\n\t\t\t</div>\n\t\t`;\n\t\tif (range > 0)\n\t\t{\n\t\t\tdiv.addEventListener('click', this.onclickHandle);\n\t\t}\n\t\treturn div;\n\t}\n\n\tstatic getPromise({userId, isNarrow, data}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\t(data ?\n\t\t\t\tPromise.resolve({data}) :\n\t\t\t\tajax.runComponentAction(\n\t\t\t\t\t'bitrix:intranet.ustat.department',\n\t\t\t\t\t'getJson',\n\t\t\t\t\t{mode: 'class', data: {}}\n\t\t\t\t))\n\t\t\t\t.then(({data}) => {\n\t\t\t\t\tconst ustat = new this(data);\n\t\t\t\t\tresolve(isNarrow ? ustat.showData() : ustat.showWideData());\n\t\t\t\t})\n\t\t\t\t.catch((errors) => {\n\t\t\t\t\terrors = Type.isArray(errors) ? errors : [errors];\n\t\t\t\t\tconst node = document.createElement('ul');\n\t\t\t\t\terrors.forEach(({message}) => {\n\t\t\t\t\t\tconst errorNode = document.createElement('li');\n\t\t\t\t\t\terrorNode.innerHTML = message;\n\t\t\t\t\t\terrorNode.className = 'ui-alert-message';\n\t\t\t\t\t\tnode.appendChild(errorNode);\n\t\t\t\t\t});\n\t\t\t\t\tresolve(Tag.render`\n\t\t\t\t\t\t<div class=\"ui-alert ui-alert-danger\">\n\t\t\t\t\t\t\t${node}\n\t\t\t\t\t\t</div>`)\n\t\t\t\t});\n\n\t\t});\n\t}\n}","import {Uri, Type, Tag, Cache, Loc, Browser, Text} from 'main.core';\nimport {EventEmitter} from 'main.core.events';\nimport {PopupComponentsMaker} from 'ui.popupcomponentsmaker';\nimport {StressLevel} from './stress-level';\nimport ThemePicker from './theme-picker';\nimport {Menu} from 'main.popup';\nimport 'main.qrcode';\nimport Options from \"./options\";\nimport Ustat from \"./ustat\";\nimport {QrAuthorization} from \"ui.qrauthorization\";\n\nconst widgetMarker = Symbol('user.widget');\nexport default class Widget extends EventEmitter\n{\n\t#container: Element;\n\t#popup: ?PopupComponentsMaker;\n\t#profile = null;\n\t#features = {};\n\t#cache = new Cache.MemoryCache();\n\n\n\tconstructor(container, {\n\t\tprofile: {ID, FULL_NAME, PHOTO, STATUS, URL, WORK_POSITION},\n\t\tcomponent: {componentName, signedParameters},\n\t\tfeatures\n\t})\n\t{\n\t\tsuper();\n\t\tthis.setEventNamespace(Options.eventNameSpace);\n\t\tthis.#container = container;\n\t\tthis.#profile = {ID, FULL_NAME, PHOTO, STATUS, URL, WORK_POSITION};\n\t\tthis.#features = features;\n\t\tif (!Type.isStringFilled(this.#features.browser))\n\t\t{\n\t\t\tthis.#features.browser =\n\t\t\t\t(Browser.isLinux() ? 'Linux'\n\t\t\t\t: (Browser.isWin() ? 'Windows' : 'MacOs')\n\t\t\t\t)\n\t\t\t;\n\t\t}\n\n\t\tthis.#cache.set('componentParams', {componentName, signedParameters});\n\t\tthis.hide = this.hide.bind(this);\n\t}\n\n\ttoggle()\n\t{\n\t\tif (this.getPopup().isShown())\n\t\t{\n\t\t\tthis.hide();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.show();\n\t\t}\n\t}\n\n\thide()\n\t{\n\t\tthis.getPopup().close();\n\t}\n\n\tshow()\n\t{\n\t\tthis.getPopup().show();\n\t}\n\n\tgetPopup(): PopupComponentsMaker\n\t{\n\t\tif (this.#popup)\n\t\t{\n\t\t\treturn this.#popup;\n\t\t}\n\t\tlet content = [\n\t\t\tthis.#getProfileContainer(),\n\t\t\t/*(this.#getb24NetPanelContainer() ? {\n\t\t\t\thtml: this.#getb24NetPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t(this.#getAdminPanelContainer() ? {\n\t\t\t\thtml: this.#getAdminPanelContainer(),\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t} : null),\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getThemeContainer(),\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\toverflow: true\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getMaskContainer(),\n\t\t\t\t\tdisabled: true,\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t],\n\t\t\tthis.#getCompanyPulse(!!this.#getStressLevel()) ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getCompanyPulse(!!this.#getStressLevel()),\n\t\t\t\t\toverflow: true,\n\t\t\t\t\tmarginBottom: 24,\n\t\t\t\t\tflex: this.#getStressLevel() ? 0.5 : 1\n\t\t\t\t},\n\t\t\t\tthis.#getStressLevel(),\n\t\t\t] : null,\n\t\t\tthis.#getOTPContainer(this.#getDeskTopContainer() === null) && this.#getDeskTopContainer() ?\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\tflex: 0.5,\n\t\t\t\t\thtml: this.#getQrContainer(0.7)\n\t\t\t\t},\n\t\t\t\t[\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getDeskTopContainer(),\n\t\t\t\t\t\tdisplayBlock: true\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getOTPContainer()\n\t\t\t\t]\n\t\t\t] : this.#getDeskTopContainer() || this.#getOTPContainer() ? [\n\t\t\t\t\t{\n\t\t\t\t\t\thtml: this.#getQrContainer(2),\n\t\t\t\t\t\tflex: 2\n\t\t\t\t\t},\n\t\t\t\t\tthis.#getDeskTopContainer() ?? this.#getOTPContainer()\n\t\t\t] : this.#getQrContainer(0),\n\t\t\tthis.#getLoginHistoryContainer(),\n\t\t\t{\n\t\t\t\thtml: this.#getBindings(),\n\t\t\t\tmarginBottom: 24,\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t},*/\n\t\t\t[\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getNotificationContainer() ?? null,\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\thtml: this.#getLogoutContainer(),\n\t\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t\t}\n\t\t\t]\n\t\t];\n\n\t\tconst filterFunc = (data): ?Array => {\n\t\t\tconst result = [];\n\t\t\tif (Type.isArray(data))\n\t\t\t{\n\t\t\t\tfor (let i = 0; i < data.length; i++)\n\t\t\t\t{\n\t\t\t\t\tif (Type.isArray(data[i]))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst buff = filterFunc(data[i]);\n\t\t\t\t\t\tif (buff !== null)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (Type.isArray(buff) && buff.length === 1)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff[0]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tresult.push(buff);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse if (data[i] !== null)\n\t\t\t\t\t{\n\t\t\t\t\t\tresult.push(data[i]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result.length <= 0 ? null : (\n\t\t\t\tresult.length === 1 ? result[0] : result\n\t\t\t)\n\t\t};\n\t\tcontent = filterFunc(content);\n\n\t\tconst prepareFunc = (item, index, array) => {\n\t\t\tif (Type.isArray(item))\n\t\t\t{\n\t\t\t\treturn {\n\t\t\t\t\thtml:  item.map(prepareFunc)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn {\n\t\t\t\tflex: item['flex'] || 0,\n\t\t\t\thtml: item['html'] || item,\n\t\t\t\tbackgroundColor: item['backgroundColor'] || null,\n\t\t\t\tdisabled: item['disabled'] || null,\n\t\t\t\toverflow: item['overflow'] || null,\n\t\t\t\tmarginBottom: item['marginBottom'] || null,\n\t\t\t\tdisplayBlock: item['displayBlock'] || null\n\t\t\t};\n\t\t}\n\t\tthis.#popup = new PopupComponentsMaker({\n\t\t\ttarget: this.#container,\n\t\t\tcontent: content.map(prepareFunc),\n\t\t\twidth: 400\n\t\t});\n\t\tEventEmitter.subscribe('BX.Main.InterfaceButtons:onMenuShow', this.hide);\n\t\tEventEmitter.subscribe(Options.eventNameSpace + 'onNeedToHide', this.hide);\n\t\treturn this.#popup;\n\t}\n\n\t#getProfileContainer(): Element\n\t{\n\t\treturn this.#cache.remember('profile', () => {\n\t\t\tconst onclick = (event) => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn BX.SidePanel.Instance.open(this.#profile.URL);\n\t\t\t};\n\t\t\tconst avatarNode = Tag.render`\n\t\t\t\t<span class=\"system-auth-form__profile-avatar--image\"\n\t\t\t\t\t${this.#profile.PHOTO ? `\n\t\t\t\t\t\tstyle=\"background-size: cover; background-image: url('${this.#profile.PHOTO}')\"` : ''}>\n\t\t\t\t</span>\n\t\t\t\t`;\n\t\t\tconst nameNode = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__profile-name\">${this.#profile.FULL_NAME}</div>\n\t\t\t`;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Avatar:changed',\n\t\t\t\t({data: [{url}]}) => {\n\t\t\t\t\tthis.#profile.PHOTO = url;\n\t\t\t\t\tavatarNode.style = Type.isStringFilled(url) ?\n\t\t\t\t\t\t`background-size: cover; background-image: url('${this.#profile.PHOTO}')` : '';\n\t\t\t\t})\n\t\t\t;\n\t\t\tEventEmitter.subscribe(\n\t\t\t\tEventEmitter.GLOBAL_TARGET,\n\t\t\t\t'BX.Intranet.UserProfile:Name:changed',\n\t\t\t\t({data: [{fullName}]}) => {\n\t\t\t\t\tthis.#profile.FULL_NAME = fullName;\n\t\t\t\t\tnameNode.innerHTML = fullName;\n\t\t\t\t\tthis.#container.querySelector('#user-name').innerHTML = fullName;\n\t\t\t\t})\n\t\t\t;\n\t\t\tlet workPosition = (Type.isStringFilled(this.#profile.WORK_POSITION) ? Text.encode(this.#profile.WORK_POSITION) : '');\n\t\t\tif (this.#profile.STATUS && Loc.hasMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS))\n\t\t\t{\n\t\t\t\tworkPosition = Loc.getMessage('INTRANET_USER_PROFILE_' + this.#profile.STATUS)\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t<div class=\"system-auth-form__profile\">\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-avatar\">\n\t\t\t\t\t\t\t${avatarNode}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-content --margin--right\">\n\t\t\t\t\t\t\t${nameNode}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__profile-position\">${workPosition}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__profile-controls\">\n\t\t\t\t\t\t\t<span class=\"ui-qr-popupcomponentmaker__btn --large --border\" >\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_PROFILE')}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t \t\t<!-- <span class=\"ui-qr-popupcomponentmaker__btn --large --success\">any text</span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getb24NetPanelContainer()\n\t{\n\t\treturn this.#cache.remember('b24netPanel', () => {\n\t\t\tif (this.#features['b24netPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"https://www.bitrix24.net/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --network\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_PROFILE_B24NET')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getAdminPanelContainer()\n\t{\n\t\treturn this.#cache.remember('adminPanel', () => {\n\t\t\tif (this.#features['adminPanel'] !== 'Y')\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a class=\"system-auth-form__item system-auth-form__scope --center --padding-sm --clickable\" href=\"/bitrix/admin/\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --admin-panel\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('INTRANET_USER_PROFILE_ADMIN_PANEL')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --block\">\n\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_GOTO')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</a>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getThemeContainer(): Element\n\t{\n\t\treturn this.#cache.remember('themePicker', () => {\n\t\t\tif (this.#features['themePicker'] === null)\n\t\t\t{\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tconst themePicker = new ThemePicker(this.#features['themePicker']);\n\t\t\tthemePicker.subscribe('onOpen', this.hide);\n\t\t\treturn themePicker.getPromise();\n\t\t});\n\t}\n\n\t#getMaskContainer(): Element\n\t{\n\t\treturn this.#cache.remember('Mask', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --mask\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">\n\t\t\t\t\t\t\t<span>${Loc.getMessage('INTRANET_USER_PROFILE_MASKS')}</span>\n\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help\"></span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn\">${Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-new --soon\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_SOON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getCompanyPulse(isNarrow): Element\n\t{\n\t\treturn this.#cache.remember('getCompanyPulse', () => {\n\t\t\tif (this.#features.pulse === 'Y'\n\t\t\t\t&& this.#profile.ID > 0\n\t\t\t\t&& this.#profile.ID === Loc.getMessage('USER_ID')\n\t\t\t)\n\t\t\t{\n\t\t\t\treturn Ustat.getPromise({\n\t\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\t\tisNarrow,\n\t\t\t\t\tdata: this.#features['pulseData'] ?? null\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn null;\n\t\t});\n\t}\n\n\t#getStressLevel(): Promise\n\t{\n\t\tif (this.#features['stressLevel'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tconst result = this.#cache.remember('getStressLevel', () => {\n\t\t\treturn StressLevel.getPromise({\n\t\t\t\tsignedParameters: this.#cache.get('componentParams').signedParameters,\n\t\t\t\tcomponentName: this.#cache.get('componentParams').componentName,\n\t\t\t\tuserId: this.#profile.ID,\n\t\t\t\tdata: this.#features['stressLevelData'] ?? null\n\t\t\t});\n\t\t});\n\t\tthis.#cache.delete('componentParams');\n\t\treturn result;\n\t}\n\n\t#getQrContainer(flex): Element\n\t{\n\t\treturn this.#cache.remember('getQrContainer', () => {\n\t\t\tconst isInstalled = this.#features['appInstalled']['APP_ANDROID_INSTALLED'] === 'Y'\n\t\t\t\t|| this.#features['appInstalled']['APP_IOS_INSTALLED'] === 'Y';\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\t(new QrAuthorization({\n\t\t\t\t\ttitle: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_TITLE2'),\n\t\t\t\t\tcontent: Loc.getMessage('INTRANET_USER_PROFILE_QRCODE_BODY2'),\n\t\t\t\t\thelpLink: ''\n\t\t\t\t})).show();\n\t\t\t}\n\t\t\tconst onclickHelp = (event: MouseEvent) => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=14999860');\n\t\t\t\tthis.hide();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t};\n\t\t\tlet node;\n\t\t\tif (flex !== 2 && flex !== 0)\n\t\t\t{\n\t\t\t\t// for a small size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''}  --clickable\" onclick=\"${onclick}\" style=\"padding: 10px 14px\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center --column --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --center --margin-xl\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr\" style=\"margin-bottom: 12px\">\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR_SMALL')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__icon-help --absolute\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse if (flex === 0)\n\t\t\t{\n\t\t\t\t//full size\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-qr-xl\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --l\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2')}</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclickHelp}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --large --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --full-size\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t// for flex 2. It is kind of middle\n\t\t\t\tnode = Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope ${isInstalled ? '--active' : ''} --padding-mid-qr  --clickable\" onclick=\"${onclick}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --column --flex --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_TITLE2_SMALL')}\n\t\t\t\t\t\t\t\t<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\" title=\"${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_HOW_DOES_IT_WORK')}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_MOBILE_SHOW_QR')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --qr\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__qr --size-2\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\t\t\treturn node;\n\t\t});\n\t}\n\n\t#getDeskTopContainer(): ?Element\n\t{\n\t\tif (this.#features.browser === 'Linux')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getDeskTopContainer', () => {\n\t\t\tlet isInstalled = this.#features['appInstalled']['APP_MAC_INSTALLED'] === 'Y';\n\t\t\tlet cssPostfix = '--apple';\n\t\t\tlet title = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_APPLE');\n\t\t\tlet linkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.dmg'\n\n\t\t\tif (this.#features.browser === 'Windows')\n\t\t\t{\n\t\t\t\tisInstalled = this.#features['appInstalled']['APP_WINDOWS_INSTALLED'] === 'Y';\n\t\t\t\tcssPostfix = '--windows';\n\t\t\t\ttitle = Loc.getMessage('INTRANET_USER_PROFILE_DESKTOP_WINDOWS');\n\t\t\t\tlinkToDistributive = 'https://dl.bitrix24.com/b24/bitrix24_desktop.exe'\n\t\t\t}\n\t\t\tconst onclick = isInstalled ? (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tevent.stopPropagation();\n\t\t\t\treturn false;\n\t\t\t} : () => {\n\t\t\t\tthis.hide();\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t\t{\n\t\t\t\tlet menuPopup = null;\n\t\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\t\titems: [{\n\t\t\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD'),\n\t\t\t\t\t\t\t\thref: linkToDistributive,\n\t\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}],\n\t\t\t\t\t\tangle: true,\n\t\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\t\tevents: {\n\t\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t})));\n\t\t\t\t\tmenuPopup.toggle();\n\t\t\t\t};\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div data-role=\"desktop-item\" class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --center --display-flex\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">${title}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --center --display-flex\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image ${cssPostfix}\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title ${isInstalled ? ' --without-margin' : '--min-height'}\">${title}</div>\n\t\t\t\t\t\t${isInstalled ?\n\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t<a href=\"${linkToDistributive}\" class=\"system-auth-form__item-title --link-dotted\">${Loc.getMessage('INTRANET_USER_PROFILE_DOWNLOAD')}</a>\n\t\t\t\t\t\t\t` : ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --center --center-force\">\n\t\t\t\t\t\t\t<a class=\"ui-qr-popupcomponentmaker__btn\" href=\"${linkToDistributive}\" target=\"_blank\" onclick=\"${onclick}\">\n\t\t\t\t\t\t\t\t${isInstalled ? Loc.getMessage('INTRANET_USER_PROFILE_INSTALLED') : Loc.getMessage('INTRANET_USER_PROFILE_INSTALL')}\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getOTPContainer(single): Element\n\t{\n\t\tif (Type.isPlainObject(this.#features['otp']) === false)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getOTPContainer', () => {\n\t\t\tconst isInstalled = this.#features['otp']['IS_ACTIVE'] === 'Y' || this.#features['otp']['IS_ACTIVE'] === true;\n\t\t\tconst onclick = () => {\n\t\t\t\tthis.hide();\n\t\t\t\tif (String(this.#features['otp']['URL']).length > 0)\n\t\t\t\t{\n\t\t\t\t\tUri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'});\n\t\t\t\t\tBX.SidePanel.Instance.open(Uri.addParam(this.#features['otp']['URL'], {page: 'otpConnected'}), {width: 1100});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tconsole.error('Otp page is not defined. Check the component params');\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst button = isInstalled ?\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURNED_ON')}</div>`\n\t\t\t\t:\n\t\t\t\tTag.render`<div class=\"ui-qr-popupcomponentmaker__btn\" style=\"margin-top: auto\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_TURN_ON')}</div>`;\n\t\t\tconst onclickHelp = () => {\n\t\t\t\ttop.BX.Helper.show('redirect=detail&code=6641271');\n\t\t\t\tthis.hide();\n\t\t\t};\n\t\t\tif (single !== true)\n\t\t\t{\n\t\t\t\treturn Tag.render`\n\t\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-bottom-10 ${isInstalled ? ' --active' : ''}\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --flex-start\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --without-margin --block\">\n\t\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}&nbsp;<span class=\"system-auth-form__icon-help --inline\" onclick=\"${onclickHelp}\"></span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t${isInstalled ?\n\t\t\t\t\t\t\t\tTag.render`\n\t\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --link-dotted\" onclick=\"${onclick}\">${Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE')}</div>\n\t\t\t\t\t\t\t\t` : ''\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-content --margin-top-auto --center --center-force\">\n\t\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new\">\n\t\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t\t</div>`\n\t\t\t\t\t\t}\n\t\t\t\t\t</div>\n\t\t\t\t`;\n\t\t\t}\n\n\t\t\tlet menuPopup = null;\n\t\t\tconst popupClick = (event: MouseEvent) => {\n\t\t\t\tmenuPopup = (menuPopup || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: event.target,\n\t\t\t\t\titems: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttext: Loc.getMessage('INTRANET_USER_PROFILE_CONFIGURE'),\n\t\t\t\t\t\t\tonclick: () => {\n\t\t\t\t\t\t\t\tmenuPopup.close();\n\t\t\t\t\t\t\t\tonclick();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\tangle: true,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tmenuPopup.toggle();\n\t\t\t};\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm-all ${isInstalled ? ' --active' : ''} --vertical --center\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo --margin-bottom --center system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --authentication\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light --center --s\">\n\t\t\t\t\t\t\t${Loc.getMessage('INTRANET_USER_PROFILE_OTP_MESSAGE')}\n\t\t\t\t\t\t\t<!-- <span class=\"system-auth-form__icon-help\" onclick=\"${onclickHelp}\"></span> -->\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? Tag.render`<div class=\"system-auth-form__config --absolute\" onclick=\"${popupClick}\"></div>` : ''}\n\t\t\t\t\t<div class=\"system-auth-form__item-container --flex --column --space-around\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content --flex --display-flex\">\n\t\t\t\t\t\t\t${button}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t${isInstalled ? '' : `\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new system-auth-form__item-new-icon --ssl\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_OTP_TITLE')}</div>\n\t\t\t\t\t\t</div>`\n\t\t\t\t\t}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\t#getLoginHistoryContainer(): Element\n\t{\n\t\treturn this.#cache.remember('getLoginHistoryContainer', () => {\n\t\t\tif (this.#features['history'])// for the future\n\t\t\t{\n\t\t\t\tTag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --vertical\">\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center --border\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --history\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__item-title --sm\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_TITLE')}</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__item-content\">\n\t\t\t\t\t\t\t<div class=\"ui-qr-popupcomponentmaker__btn --border\">Logout</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__visited\">\n\t\t\t\t\t\t<div class=\"system-auth-form__visited-item\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-icon --apple\"></div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-text\">Device 2</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-action\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"system-auth-form__visited-item\">\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-icon --android\"></div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-text\">Device 1</div>\n\t\t\t\t\t\t\t<div class=\"system-auth-form__visited-action\"></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container\">\n\t\t\t\t\t\t<div class=\"system-auth-form__show-history\">Logout</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\t}\n\n\t\t\tlet resultEmpty = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --center --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --history-gray\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title\">${Loc.getMessage('INTRANET_USER_PROFILE_HISTORY_TITLE')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-new --soon\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-new--title\">${Loc.getMessage('INTRANET_USER_PROFILE_SOON')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\n\t\t\treturn {\n\t\t\t\thtml: resultEmpty,\n\t\t\t\tdisabled: true,\n\t\t\t\tbackgroundColor: '#fafafa'\n\t\t\t}\n\t\t});\n\t}\n\n\t#getBindings(): ?Element\n\t{\n\t\tif (!(Type.isPlainObject(this.#features['bindings'])\n\t\t\t&& Type.isStringFilled(this.#features['bindings']['text'])\n\t\t\t&& Type.isArray(this.#features['bindings']['items'])\n\t\t\t&& this.#features['bindings']['items'].length > 0\n\t\t))\n\t\t{\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this.#cache.remember('getBindingsContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --center --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --binding\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Text.encode(this.#features['bindings']['text'])}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div data-role=\"arrow\" class=\"system-auth-form__item-icon --arrow-right\"></div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.__bindingsMenu = (this.__bindingsMenu || (new Menu({\n\t\t\t\t\tclassName: 'system-auth-form__popup',\n\t\t\t\t\tbindElement: div.querySelector('[data-role=\"arrow\"]'),\n\t\t\t\t\titems: this.#features['bindings']['items'],\n\t\t\t\t\tangle: true,\n\t\t\t\t\tcachable: false,\n\t\t\t\t\toffsetLeft: 10,\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonShow: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(false);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonClose: () => {\n\t\t\t\t\t\t\tthis.getPopup().getPopup().setAutoHide(true);\n\t\t\t\t\t\t\tif (this.__bindingsMenu.isNeedToHide !== false)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis.hide();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})));\n\t\t\t\tthis.__bindingsMenu.isNeedToHide = false;\n\t\t\t\tthis.__bindingsMenu.toggle();\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthis.__bindingsMenu.isNeedToHide = true;\n\t\t\t\t}, 0);\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getNotificationContainer(): Element\n\t{\n\t\tif (this.#features['im'] !== 'Y')\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\treturn this.#cache.remember('getNotificationContainer', () => {\n\t\t\tconst div = Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item --hover system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --notification\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_NOTIFICATION')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\tdiv.addEventListener('click', () => {\n\t\t\t\tthis.hide();\n\t\t\t\tBXIM.openSettings({'onlyPanel':'notify'});\n\t\t\t});\n\t\t\treturn div;\n\t\t});\n\t}\n\n\t#getLogoutContainer(): Element\n\t{\n\t\treturn this.#cache.remember('getLogoutContainer', () => {\n\t\t\tconst backUrl = new Uri(window.location.pathname);\n\t\t\tbackUrl.removeQueryParam(['logout', 'login', 'back_url_pub', 'user_lang']);\n\t\t\tconst newUrl =  new Uri('/auth/?logout=yes');\n\t\t\tnewUrl.setQueryParam('sessid', BX.bitrix_sessid());\n\t\t\tnewUrl.setQueryParam('backurl', encodeURIComponent(backUrl.toString()));\n\t\t\t//TODO   \n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"system-auth-form__item system-auth-form__scope --padding-sm\">\n\t\t\t\t\t<div class=\"system-auth-form__item-logo\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-logo--image --logout\"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"system-auth-form__item-container --center\">\n\t\t\t\t\t\t<div class=\"system-auth-form__item-title --light\">${Loc.getMessage('AUTH_LOGOUT')}</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<a href=\"${newUrl.toString()}\" class=\"system-auth-form__item-link-all\"></a>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tstatic init(node, options)\n\t{\n\t\tif (node[widgetMarker])\n\t\t{\n\t\t\treturn;\n\t\t}\n\t\tconst onclick = () => {\n\t\t\tif (!node['popupSymbol'])\n\t\t\t{\n\t\t\t\tnode['popupSymbol'] = new this(node, options);\n\t\t\t}\n\t\t\tnode['popupSymbol'].toggle();\n\t\t\tthis.instance = node['popupSymbol'];\n\t\t};\n\t\tnode[widgetMarker] = true;\n\t\tnode.addEventListener('click', onclick);\n\t\tsetTimeout(onclick, 100);\n\t}\n\n\tstatic instance = null;\n\n\tstatic getInstance():? this\n\t{\n\t\treturn this.instance;\n\t}\n}"],"names":["Options","StressLevel","url","Type","isStringFilled","EventEmitter","emit","GLOBAL_TARGET","eventNameSpace","BX","SidePanel","Instance","open","cacheable","data","width","value","parseInt","result","Tag","render","Loc","getMessage","Text","encode","type","typeDescription","getOpenSliderFunction","check","comment","setTimeout","intervalId","setInterval","current","node","innerHTML","end","clearInterval","querySelector","style","transform","signedParameters","componentName","userId","Promise","resolve","reject","promise","ajax","runAction","c","fields","then","id","undefined","showData","showEmpty","document","createElement","error","urls","ThemePicker","Object","assign","lightning","String","indexOf","applyTheme","bind","setEventNamespace","subscribe","theme","title","previewImage","previewColor","container","getContainer","removeProperty","backgroundImage","backgroundSize","background","backgroundColor","Dom","removeClass","addClass","onclick","Intranet","Bitrix24","Singleton","showDialog","Ustat","onclickHandle","myPosition","userList","range","div","UI","Hint","init","event","window","openIntranetUStat","addEventListener","isNarrow","runComponentAction","mode","ustat","showWideData","errors","isArray","forEach","message","errorNode","className","appendChild","createDocumentFragment","myActivity","usersData","isPlainObject","values","length","ACTIVITY","dataResult","slice","userRating","index","fullName","avatarSrc","join","isCurrentUser","widgetMarker","Symbol","Widget","profile","ID","FULL_NAME","PHOTO","STATUS","URL","WORK_POSITION","component","features","Cache","MemoryCache","browser","Browser","isLinux","isWin","set","hide","getPopup","isShown","show","close","content","html","filterFunc","i","buff","push","prepareFunc","item","array","map","flex","disabled","overflow","marginBottom","displayBlock","PopupComponentsMaker","target","options","toggle","instance","remember","avatarNode","nameNode","workPosition","hasMessage","BXIM","openSettings","backUrl","Uri","location","pathname","removeQueryParam","newUrl","setQueryParam","bitrix_sessid","encodeURIComponent","toString"],"mappings":"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"}